<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">

<!--
    <link rel="icon" href="lib/3rdParty/bootstrap/favicon.ico">
    <title>Cover Template for Bootstrap</title>
-->
    <link rel="icon" href="favicon.ico">
    <title>Wahana Prestasi Logistik</title>

    <!-- Bootstrap core CSS -->
    <link href="assets/css/bootstrap.min.css" rel="stylesheet">
     <link href="assets/css/one.style.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="assets/css/cover.css" rel="stylesheet">
    <link href="assets/css/hover-min.css" rel="stylesheet">
    <link href="assets/css/shortcode_timeline2.css" rel="stylesheet">
    <script src="https://unpkg.com/jspdf@latest/dist/jspdf.min.js"></script>
    <!--   <script src="assets/js/html2canvas.min.js"></script> -->
    <link href="assets/css/select2.css" rel="stylesheet" />

<!--    <link href="assets/css/sticky-footer-navbar.css" rel="stylesheet"> -->
  </head>
<style>
.autocomplete-suggestions { border: 1px solid #999;text-align: left;background: #FFF; overflow: auto; }
/*.autocomplete-suggestion { padding: 2px 5px; white-space: nowrap; overflow: hidden; }*/
.autocomplete-suggestion { padding: 2px 5px; overflow: hidden; }
.autocomplete-selected { background: #F0F0F0; }
.autocomplete-suggestions strong { font-weight: normal; color: #3399FF; }
.autocomplete-group { padding: 2px 5px; }
.autocomplete-group strong { display: block; border-bottom: 1px solid #000; }

/*
.hvr-sweep-to-right::before{
  background: #0202ff;
}
.hvr-sweep-to-right:hover{
  color: white;
}
.demo{
  position: absolute;
  font-size: 10px;
}
*/
.dropdown-caret{
  position: relative;
}
.dropdown-caret::before{
  position: absolute;
  font-family: FontAwesome;
			content: " \f0d7";
      color: #444;
			top: 5px;
			height: 20px;
      left: calc(100% - 5%);
}
select.form-control:not([size]):not([multiple]){
  height: calc(1.90rem + 2px) !important;
}
</style>
  <body class="text-center">
    <div class="cover-container d-flex w-100 h-100 mx-auto flex-column">
    <nav class="navbar navbar-expand-lg sticky-top">
  <a class="navbar-brand" href="#"><img class="rounded" src="wahana/images/logo-wahana.png"></a>
  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
    <i class="fa fa-bars" aria-hidden="true"></i>
  </button>
  <div class="collapse navbar-collapse" id="navbarSupportedContent">
    <ul class="navbar-nav ml-auto">
      <li class="nav-item">
        <a class="nav-link nav-mastlink hvr-sweep-to-right" href="index.html">Beranda</a><span >&nbsp;|&nbsp;</span>
      </li>
      <li class="nav-item">
        <a class="nav-link nav-mastlink hvr-sweep-to-right" href="index.html#tariff">Cek Tarif</a><span >&nbsp;|&nbsp;</span>
      </li>
      <li class="nav-item">
        <a class="nav-link nav-mastlink hvr-sweep-to-right" href="index.html#track">Lacak Pengiriman</a><span >&nbsp;|&nbsp;</span>
      </li>
      <li class="nav-item">
        <a class="nav-link nav-mastlink hvr-sweep-to-right" href="index.html#agentloc">Agen Terdekat</a><span >&nbsp;|&nbsp;</span>
      </li>
      <li class="nav-item">
        <a class="nav-link nav-mastlink hvr-sweep-to-right" href="peluang_bisnis.html">Peluang Bisnis</a><span >&nbsp;|&nbsp;</span>
      </li>
      <li class="nav-item">
        <a class="nav-link nav-mastlink hvr-sweep-to-right" href="contactus.html">Hubungi CS</a><span >&nbsp;|&nbsp;</span>
      </li>
      <li class="nav-item">
        <a class="nav-link nav-mastlink hvr-sweep-to-right" href="cgi-bin/dw.cgi">Masuk</a>
      </li>
    </ul>
  </div>
</nav>
      <main role="main" class="inner cover pt-4 main-container mx-auto">

        <div data-spy="scroll"  data-target="#navbar-example2" data-offset="0" >
        <div class="card bg-transparent mt-2">
        <div class="card-body">
        			<h4 class="text-center">Cek Tarif</h4>
        			<form class="" action="JavaScript:void(0)">
        			<div class="form-row">
                <!--
        				<div class="form-group col-sm-3">
        					<label class="sr-only" for="serviceId">Service</label>
                  <!--
        					<select class="form-control form-control-sm" id="service" data-toggle="tooltip" data-html="true" title="Pilih Layanan">
        						<option disabled>Layanan</option>
        						<option value="7">Express Normal</option>
        						<option value="5">Express Prioritas</option>
        						<!-- <option value="8994">Tujuan Khusus</option>
                    <optgroup label="Tujuan Khusus">
                      <option value="volvo">Tujuan Khusus Apatermen</option>
                      <option value="saab">Tujuan Khusus Gedung Perkantoran</option>
                    </optgroup>
        					</select>
        				</div>
              -->
        				<div class="form-group col-sm-4">
        					<label class="sr-only">Kota Asal</label>
                  <select id="calculateFrom" class="form-control" data-toggle="tooltip" data-html="true" title="Pilih Kota Asal">
                    <option value="000000" data-id=")">Kota Asal</option>
            </select>
        				</div>
        				<div class="form-group col-sm-2">
        					<label class="sr-only">Propinsi</label>
                  <select id="getProp" class="form-control" data-toggle="tooltip" data-html="true" title="Pilih Kota Asal">
                    <option value="000000" data-id=")">Propinsi</option>
            </select>
        				</div>
                <div class="form-group col-sm-2">
        					<label class="sr-only">Kabupaten</label>
                    <select id="getKab" class="form-control" data-toggle="tooltip" data-html="true" title="Pilih Kota Asal">
                      <option value="000000" data-id=")">Kabupaten / Kota</option>
                    </select>
        				</div>
                <div class="form-group col-sm-2">
        					<label class="sr-only">Kecamatan</label>
                  <select id="getKec" class="form-control" data-toggle="tooltip" data-html="true" title="Pilih Kota Asal">
                    <option value="000000" data-id=")">Kecamatan</option>
                  </select>
        				</div>
                <div class="form-group col-sm-2">
        					<label class="sr-only">Kelurahan</label>
                  <select id="getKel" class="form-control" data-toggle="tooltip" data-html="true" title="Pilih Kota Asal">
                    <option value="000000" data-id=")">Kelurahan</option>
                  </select>
        				</div>
        			</div>
        			<div class="form-row">
        				<div class="form-group col-sm-2">
        					<label class="sr-only">Weight</label>
        					<div class="input-group">
        						<input id="calculateWeight" data-toggle="tooltip" data-html="true" title="Berat" placeholder="Berat" class="form-control form-control-sm" type="text" value="1">
        						<div class="input-group-append">
        							<span class="input-group-text">KG</span>
        						</div>
        					</div>
        				</div>
        					<div class="form-group col-sm-2">
        						<label class="sr-only">Length</label>
        						<div class="input-group">
        							<input id="calculateLength" placeholder="Panjang" data-toggle="tooltip" data-html="true" title="Panjang" class="form-control form-control-sm" type="text" value="1">
        							<div class="input-group-append">
        								<span class="input-group-text">CM</span>
        							</div>
        						</div>
        					</div>
        					<div class="form-group col-sm-2">
        						<label class="sr-only">Width</label>
        						<div class="input-group">
        							<input id="calculateWide" placeholder="Lebar" class="form-control form-control-sm" data-toggle="tooltip" data-html="true" title="Lebar" type="text" value="1">
        							<div class="input-group-append">
        								<span class="input-group-text">CM</span>
        							</div>
        						</div>
        					</div>
        					<div class="form-group col-sm-2">
        						<label class="sr-only">Height</label>
        						<div class="input-group">
        							<input id="calculateHeight" placeholder="Tinggi" class="form-control form-control-sm" data-toggle="tooltip" data-html="true" title="Tinggi" type="text" value="1">
        							<div class="input-group-append">
        								<span class="input-group-text">CM</span>
        							</div>
        						</div>
        					</div>

                      <input type="hidden" data-name="" id="propID" placeholder="Tinggi" class="form-control form-control-sm" type="text" value="">
                      <input type="hidden" data-name="" id="kabID" placeholder="Tinggi" class="form-control form-control-sm" type="text" value="">
                      <input type="hidden" data-name="" id="kecID" placeholder="Tinggi" class="form-control form-control-sm" type="text" value="">
        							<input type="hidden" data-name="" id="dataAsalId" placeholder="Tinggi" class="form-control form-control-sm" type="text" value="">

        							<input type="hidden" data-name="" id="dataTujuanId" placeholder="Tinggi" class="form-control form-control-sm" type="text" value="">

        				<div class="form-group col-sm-4" id="track" >
        					<button  onClick="calculate()" id="cek" data-toggle="tooltip" data-html="true" title="Cek Sekarang!" class="btn btn-block btn-index"><b>Cek</b><i id="spinnercek" class="hidden fa fa-cog fa-spin fa-fw"></i></button>
        				</div>
        			</div>
              </div>
        			</form>
        </div>
        </div>



  </main>

    <div class="modal fade fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Cek tarif</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body text-center" style="max-width:100%;" id="testing">
        <span id="first-visible" class="text-center"></span>
      </div>
      <div class="modal-footer">
          <button type="button" id="btnDownload" class="btn btn-primary">Download Image</button>
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>


</div>

      <!-- Bootstrap core JavaScript
      ================================================== -->
      <!-- Placed at the end of the document so the pages load faster -->
      <script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
      <script src="https://use.fontawesome.com/2e37f68334.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.6-rc.0/js/select2.min.js"></script>
      <script src="https://superal.github.io/canvas2image/canvas2image.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/0.4.1/html2canvas.min.js"></script>
      <script src="assets/js/jquery.autocomplete.min.js"></script>
      <script src="assets/js/main.js"></script>
      <script>window.jQuery || document.write('<script src="lib/3rdParty/bootstrap/assets/js/vendor/jquery-slim.min.js"><\/script>')</script>
      <script src="assets/js/popper.min.js"></script>
      <script src="assets/js/bootstrap.min.js"></script>

<script>

var htmlSource = $('#testing')[0];
$('#btnDownload').on("click", function() {

  html2canvas(htmlSource, {
   onrendered: function(canvas) {

     // document.body.appendChild(canvas);
     return Canvas2Image.saveAsPNG(canvas);
   }
 });
  })
</script>
<script>

//Tampilkan Propinsi
function formatState (state) {
if (!state.id) {
return state.text;
}
var state1 = state.text;
return state1;
};
function selection(state) {
return state.text;
}
function makeSelect2prop(data) {
$('#getProp').select2({
  data: data,
  placeholder : "Masukkan Kota Propinsi",
  width: '100%',
  templateSelection: selection,
  templateResult: formatState,
  escapeMarkup: function (state) {
      return state;
  },
});
}
$(document).ready(function(){
$.ajax({
type: "get",
dataType: "json",
async: true,
url: "https://weblib.wahana.com/Ajaxx/getProp",
success: function (data) {
  //console.log(data)
    makeSelect2prop(data);
}
});
})
$('#getProp').on('select2:select', function (e) {
var data = e.params.data;
$("#propID").val(data.id)
$("#propID").attr("data-name",data.text)

});
</script>

<script>
//Tampilkan Kabupaten
$("#getProp").change(function(){
function formatState (state) {
if (!state.id) {
return state.text;
}
var state1 = state.text;
return state1;
};
function selection(state) {
return state.text;
}
function makeSelect2kab(data) {
$('#getKab').select2({
  data: data,
  placeholder : "Masukkan Kota Propinsi",
  width: '100%',
  templateSelection: selection,
  templateResult: formatState,
  escapeMarkup: function (state) {
      return state;
  },
});
}
$(document).ready(function(){
$.ajax({
type: "post",
dataType: "json",
async: true,
data : "idKab="+$("#propID").val(),
url: "https://weblib.wahana.com/Ajaxx/getKab",
success: function (data) {
  //console.log(data)
  console.log(data)
    makeSelect2kab(data);
}
});
})
$('#getKab').on('select2:select', function (e) {
var data = e.params.data;
$("#kabID").val(data.id)
$("#kabID").attr("data-name",data.text)
});
})
</script>

<script>
//Tampilkan Kec
$("#getKab").change(function(){
function formatState (state) {
if (!state.id) {
return state.text;
}
var state1 = state.text;
return state1;
};
function selection(state) {
return state.text;
}
function makeSelect2kec(data) {
$('#getKec').select2({
  data: data,
  placeholder : "Masukkan Kota Propinsi",
  width: '100%',
  templateSelection: selection,
  templateResult: formatState,
  escapeMarkup: function (state) {
      return state;
  },
});
}
$(document).ready(function(){
$.ajax({
type: "post",
dataType: "json",
async: true,
data : "idKec="+$("#kabID").val(),
url: "https://weblib.wahana.com/Ajaxx/getKec",
success: function (data) {
  //console.log(data)
  console.log(data)
    makeSelect2kec(data);
}
});
})
$('#getKec').on('select2:select', function (e) {
var data = e.params.data;
$("#kecID").val(data.id)
$("#kecID").attr("data-name",data.text)
});
})
</script>

<script>
//Tampilkan Kel
$("#getKec").change(function(){
function formatState (state) {
if (!state.id) {
return state.text;
}
var state1 = state.text;
return state1;
};
function selection(state) {
return state.text;
}
function makeSelect2kel(data) {
$('#getKel').select2({
  data: data,
  placeholder : "Masukkan Kota Propinsi",
  width: '100%',
  templateSelection: selection,
  templateResult: formatState,
  escapeMarkup: function (state) {
      return state;
  },
});
}
$(document).ready(function(){
$.ajax({
type: "post",
dataType: "json",
async: true,
data : "idKel="+$("#kecID").val(),
url: "https://weblib.wahana.com/Ajaxx/getKel",
success: function (data) {
  //console.log(data)
  console.log(data)
    makeSelect2kel(data);
}
});
})
$('#getKel').on('select2:select', function (e) {
var data = e.params.data;
$("#dataTujuanId").val(data.id)
$("#dataTujuanId").attr("data-name",data.text)
});
})
</script>

<script type="text/javascript">

function formatState (state) {
if (!state.id) {
return state.text;
}
var state1 = state.text;
return state1;
};
function selection(state) {
return state.text;
}
function makeSelect2(data) {
$('#calculateFrom').select2({
  data: data,
  placeholder : "Masukkan Kota Asal",
  width: '100%',
  templateSelection: selection,
  templateResult: formatState,
  escapeMarkup: function (state) {
      return state;
  },
});
}
$(document).ready(function(){
$.ajax({
type: "POST",
dataType: "json",
async: true,
url: "https://weblib.wahana.com/Ajaxx/getTariffNodeOriginNew",
success: function (data) {
  //console.log(data)
    makeSelect2(data);
}
});
})
$('#calculateFrom').on('select2:select', function (e) {
var data = e.params.data;
$("#dataAsalId").attr("data-id",data.id)
$("#dataAsalId").val(data.text)

});

function remove_duplicates_safe(arr) {
var seen = {};
var ret_arr = [];
for (var i = 0; i < arr.length; i++) {
  if (!(arr[i] in seen)) {
      ret_arr.push(arr[i]);
      seen[arr[i]] = true;
  }
}
return ret_arr;

}
$(document).ready(function(){
  $("#calculateTo").click(function(){
if ($("#dataAsalId").val().length == 0){
  swal({
    type: 'error',
    title: 'Oops...',
    html: 'Kota Asal Belum Diisi',
  })
  return false;
}

})
})
/*
      $('#calculateTo').keydown(function(e) {
            var from  = $("#dataAsalId").val();
            if(from.length == 0){
              swal({
                type: 'error',
                title: 'Oops...',
                html: 'Data Anda Belum Lengkap',
              })
                  return false;
                }
        });
*/


        function getDataOrigin(callback){
            $.post("https://wahana.com/Ajaxx/getTariffNodeOriginNew", {}, function(data){
                // console.log(data);
                callback(data);
            });
        }

        // alert(getDataOrigin(returnData));

        function autoCompletee(){
          getDataOrigin(function(data1) {
          data=JSON.parse(data1);
          var dataArray = $.map(data, function(value, key) {
            return {
              value: value,
              data: key
            };
          });
/*
          $('#calculateFrom').autocomplete({
            minChars: 3,
            deferRequestBy: 250,
            noCache : true,
            lookup: dataArray,
            onSelect: function (suggestion) {
                $("#dataAsalId").val(suggestion.data);
            }
          });
*/
          var options, a;

          $('#calculateTo').autocomplete({
              noCache : true,
              minChars: 3,
              dataType : "json",
              deferRequestBy: 250,
              serviceUrl: "https://wahana.com/Ajaxx/getTariffNodeDestinationNew",
              params: {
                  'originNodeId': function() {
                      return $('#dataAsalId').attr("data-id");
                  },
                  'constraint': function() {
                      return $('#calculateTo').val();
                  },
                  'service': function() {
                      return 7
                  }
              },
              transformResult: function(response) {

               if(response.length ==0){

              var service =7;
              var dataAsal  = $("#calculateFrom").val();
              var dataTujuan  = $("#calculateTo").val();

              if(service=='7'){
                servicekirim='Normal';
              }else if(service=='5'){
                servicekirim='Prioritas';
              }else{
                 servicekirim='Khusus';
              }

                // $('#alertModal .modal-body').html('Kota Asal  Tujuan Tidak Tersedia');
                // $('#alertModal').modal('show');


               }else{
                  return {
                      suggestions: $.map(response, function(value, key) {
                        return {
                          value: value,
                          data: key
                        };
                      })
                  };
                }
              },
              onSelect: function (suggestion) {
                  $("#dataTujuanId").val(suggestion.data);
              }
          });
          });
        }
        autoCompletee();
        function clearcalculate(){
          $("#dataAsalId").val('');
          $("#dataTujuanId").val('');
          $("#calculateTo").val('');
          $("#calculateFrom").val('');
          $("#calculateWeight").val('');

          $("#calculateLength").val('');
          $("#calculateWidth").val('');
          $("#calculateHeight").val('');


        }


        function calculate(){
        var from 	= $("#dataAsalId").attr("data-id");
        var to 		= $("#dataTujuanId").val();
        var wide 	= $("#calculateWide").val();
        var height 	= $("#calculateHeight").val();
        var weight 	= $("#calculateWeight").val();
        var length 	= $("#calculateLength").val();
        var dataAsal 	= $("#dataAsalId").val();
        var dataTujuan 	= $("#propID").attr("data-name")+", "+$("#kabID").attr("data-name")+", "+$("#kecID").attr("data-name")+", "+$("#dataTujuanId").attr("data-name")
        var service =$("#service").val();

        if(service=='7'){
        servicekirim='Normal';
        }else if(service=='5'){
        servicekirim='Prioritas';
        }else{
        servicekirim='Khusus';
        }

        var pesan_error = []
        var ll = false
        var getTotal = length * wide * height / 6000
        if (weight > 50){
          pesan_error.push("<p>Berat Tidak Boleh Lebih Dari <b>50 Kg</b></p>")
          ll = true
        }
        if (length > 180){
          pesan_error.push("<p>Panjang Tidak Boleh Lebih Dari <b>180 CM</b></p>")
          ll = true
        }
        if ( wide > 180 ){
          pesan_error.push("<p>Lebar Tidak Boleh Lebih Dari <b>180 CM</b></p>")
          ll = true
        }
        if (height > 180){
          pesan_error.push("<p>Tinggi Tidak Boleh Lebih Dari <b>180 CM</b></p></p>")
          ll = true
        }
        if (getTotal > 80){
          pesan_error.push("<p>Berat Volumetrik Tidak Boleh Lebih Dari <b>80 Kg</b></p>")
          ll = true
        }
        if (ll == true){
          console.log(pesan_error.join('\n'))

          return false;
        }
        if(weight.length == 0 || from.length == 0 || to.length == 0  || dataAsal.length == 0 || to.length == 0 || from == ")" ){
          console.log("Data anda belum lengkap")
        return false;
        }
$.ajax({
  url: "https://weblib.wahana.com/Ajaxx/getTarifHomeNew2",
  type: "post",
  data :   {'from':from, 'to':to,'height':height,'weight':weight,'length':length,'dataAsal':dataAsal,'dataTujuan':dataTujuan, 'wide':wide,'service':service },
  beforeSend : function(){
    $("#spinnercek").removeClass("hidden")
    $("#cek").addClass("disabled")
  },
  success : function(data){
    if (data != 0) {
      console.log(dataTujuan)
      console.log(from)
      console.log(parseInt(getTotal))
      $("#exampleModal").modal("show")
        $('#first-visible').html(data);
        $("#uv").val(length+"x"+wide+"x"+height)
        var bv
        if (parseInt(getTotal) < 1){
          $("#bv").val(parseInt(1))
          bv = parseInt(1)
        }else{
            $("#bv").val(parseInt(getTotal))
            bv = parseInt(getTotal)
        }
        if (bv < weight){
          //var e = numeral(parseInt(weight) * parseInt($("#hpg").attr("data-number"))).format('0,0')
          //$("#th").val(e)
          //$("#ket").html("* Berat yang digunakan adalah <span class='text-red'>Berat Timbangan</span>")
          $("#ket").html("* Tarif Dihitung Berdasarkan <span class='text-red'>Berat</span>")
        }else if(bv > weight){
          //r = numeral(parseInt(getTotal) * parseInt($("#hpg").attr("data-number"))).format('0,0')
          //$("#th").val(r)
          //$("#ket").html("* Berat yang digunakan adalah <span class='text-red'>Berat Volumetrik</span>")
          $("#ket").html("* Tarif Dihitung Berdasarkan <span class='text-red'>Dimensi</span>")
        }else if (weight == bv){
          //$("#th").val($("#tf").val())
          $("#ket").html("* Tarif Dihitung Berdasarkan <span class='text-red'>Berat</span>")
        }

        $("#bkg").val(weight)
      }
      else {
        console.log("Layanan tidak tersedia")
        console.log(dataAsal)
        console.log(from)
      }
      $("#spinnercek").addClass("hidden")
      $("#cek").removeClass("disabled")
  }
})
/*
        $.post( "https://wahana.com/Ajaxx/getTarifHomeNew",
        {'from':from, 'to':to,'height':height,'weight':weight,'length':length,'dataAsal':dataAsal,'dataTujuan':dataTujuan, 'wide':wide,'service':service },
            function() {}).done(function(data){
              if (data != 0) {

                console.log(dataTujuan)
                console.log(from)
                $("#exampleModal").modal("show")
                $("#bv").val(height)
                $("#uv").val(wide+"x"+length+"x"+weight)
                  $('#first-visible').html(data);
                }
                else {
                  alert("Layanan tidak tersedia")
                  console.log(dataAsal)
                  console.log(from)
                }
        })
*/
        }
        // reset calculate
        function resetCalculate(){
        $.get("https://wahana.com/Ajaxx/resetCalculate", { }, function(data) {
        $('#first-visible').html(data);
        autoCompletee();
        });
        }

// ajax lacak pengiriman
// ajax lacak pengiriman
$(document).ready(function(){
  $(".nav-mastlink").click(function(){
    r = $(this).attr("data-title")
    $("title").html(r)
  })
})
</script>


    </body>
  </html>
